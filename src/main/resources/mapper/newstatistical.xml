<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.graduate_sever.Dao.NewStatisticalMapper">
    <resultMap id="StatisticalNewSystem" type="com.example.graduate_sever.model.NewSyatemModel">
        <id column="id" jdbcType="INTEGER" property="id"/>
        <result column="status" jdbcType="INTEGER" property="status"/>
        <result column="finishtime" jdbcType="VARCHAR" property="finishtime"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="partment" jdbcType="VARCHAR" property="partment"/>
        <result column="badge" jdbcType="INTEGER" property="badge"/>
        <result column="shenbao" property="shenbao"/>
        <result column="metails" property="metails"/>
        <result column="type" property="type"/>
    </resultMap>

    <resultMap id="StatisticalSheKeChu" type="com.example.graduate_sever.model.SheKeChuModel">
        <id column="id" jdbcType="INTEGER" property="id"/>
        <result column="status" jdbcType="INTEGER" property="status"/>
        <result column="finishtime" jdbcType="VARCHAR" property="finishtime"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="partment" jdbcType="VARCHAR" property="partment"/>
        <result column="badge" jdbcType="INTEGER" property="badge"/>
        <result column="shenbao" property="shenbao"/>
        <result column="metails" property="metails"/>
        <result column="jietidengji" property="jietidengji"/>
        <result column="xiangmujibie" property="xiangmujibie"/>
        <result column="jianglijibie" property="jianglijibie"/>
        <result column="jianglidengji" property="jianglidengji"/>
        <result column="huojiangleibie" property="huojiangleibie"/>
        <result column="chengguotype" property="chengguotype"/>
        <result column="danwei" property="danwei"/>
    </resultMap>
    <resultMap id="NewTeacherBadge" type="java.lang.Integer"/>
    <resultMap id="TeacherName" type="java.lang.String"/>

    <select id="selectOne" resultMap="StatisticalNewSystem">
        select distinct newsystem.* from newsystem,newparticipation where newsystem.id=newparticipation.ach_id and status=1 and newparticipation.type=#{type}
        <if test="badge!=null">
            and newparticipation.badge=#{badge}
        </if>and finishtime between #{date1} and #{date2}
    </select>

    <select id="selectOneKeJiChu" resultMap="StatisticalNewSystem">
        select distinct kejichu.* from kejichu,newparticipation where kejichu.id=newparticipation.ach_id and status=1 and newparticipation.type=#{type}
        <if test="badge!=null">
            and newparticipation.badge=#{badge}
        </if>and finishtime between #{date1} and #{date2}
    </select>

    <select id="selectOneSheKeChu" resultMap="StatisticalSheKeChu">
        select distinct shekechu.* from shekechu,newparticipation where shekechu.id=newparticipation.ach_id and status=1 and newparticipation.type=#{type}
        <if test="badge!=null">
            and newparticipation.badge=#{badge}
        </if>
        and finishtime between #{date1} and #{date2}
    </select>

    <select id="selectDaiShenHeSheKeChu" resultMap="StatisticalSheKeChu">
        select * from shekechu where id=#{id}
    </select>

    <select id="selectOneNewSystem" resultMap="StatisticalNewSystem">
        select * from newsystem where id=#{id}
    </select>

    <select id="getNewBadge" resultMap="NewTeacherBadge">
        select teacher.badeg from  newparticipation,teacher where newparticipation.badge=teacher.badeg and newparticipation.ach_id=#{id} and newparticipation.type=#{type}
    </select>


    <select id="selectTeacherName" resultMap="TeacherName">
        select tea_name from  teacher where teacher.badeg=#{badge}
    </select>
</mapper>

