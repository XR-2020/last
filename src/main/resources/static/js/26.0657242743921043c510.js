webpackJsonp([26],{O81N:function(e,t){},x9wC:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("Nv5k");var l=a("k7Ck"),i=a("7GrU"),s={inject:["reload"],name:"rongyuchenghao",data:function(){return{form:{name:"",finishtime:"",people:[],level:"",role:localStorage.getItem("ms_role"),partment:"",shenbao:localStorage.getItem("ms_badge"),path:""},teacher_list:[],rules:{name:[{required:!0,message:"必填",trigger:"blur"}],partment:[{required:!0,message:"必填",trigger:"blur"}],finishtime:[{required:!0,message:"必填",trigger:"blur"}],level:[{required:!0,message:"必填",trigger:"blur"}],people:[{required:!0,message:"必填",trigger:"blur"}],path:[{required:!0,message:"必填",trigger:"blur"}]}}},created:function(){var e=this;Object(i.m)().then(function(t){e.teacher_list=t})},methods:{uploadSuccess:function(e,t,a){this.form.path=e},handleChange:function(e,t){this.$message.warning("当前限制选择 1 个文件，请删除后继续上传！")},onSubmit:function(){var e=this;this.$refs.subform.validate(function(t){t?Object(l.h)(e.form).then(function(t){0!==t.data?e.$message.success("添加成功"):e.$message.error("添加失败，教研研成果已被申报"),e.reload()}):e.$message.error("请完善信息")})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-tickets"}),e._v(" 荣誉称号申报")])],1)],1),e._v(" "),a("div",{staticClass:"container"},[a("div",{staticClass:"form-box"},[a("el-form",{ref:"subform",attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[a("el-form-item",{attrs:{label:"称号名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"级别",prop:"level"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",t)},expression:"form.level"}},[a("el-option",{key:"YuanJi",attrs:{label:"院级",value:"院级"}}),e._v(" "),a("el-option",{key:"XiaoJi",attrs:{label:"校级",value:"校级"}}),e._v(" "),a("el-option",{key:"ShengJi",attrs:{label:"省级",value:"省级"}}),e._v(" "),a("el-option",{key:"GuoJia",attrs:{label:"国家级",value:"国家级"}}),e._v(" "),a("el-option",{key:"GuoJi",attrs:{label:"国际级",value:"国际级"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"部门",prop:"partment"}},[a("el-input",{model:{value:e.form.partment,callback:function(t){e.$set(e.form,"partment",t)},expression:"form.partment"}})],1),e._v(" "),a("el-form-item",{attrs:{multiple:"",filterable:"",label:"获奖人员",prop:"people"}},[a("el-select",{attrs:{multiple:"",filterable:""},model:{value:e.form.people,callback:function(t){e.$set(e.form,"people",t)},expression:"form.people"}},e._l(e.teacher_list,function(e){return a("el-option",{key:e.badge,attrs:{label:e.badge+"—"+e.name,value:e.name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"获奖时间",prop:"finishtime"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:e.form.finishtime,callback:function(t){e.$set(e.form,"finishtime",t)},expression:"form.finishtime"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"证明材料",prop:"path"}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",accept:".zip",action:"http://localhost:8080/RongYuChengHaoMetials",limit:1,"on-exceed":e.handleChange,"on-success":e.uploadSuccess,"show-file-list":!0}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将压缩包拖到此处，或"),a("em",[e._v("点击上传")])])])],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")]),e._v(" "),e.is_editor?a("router-link",{attrs:{to:"/项目申报"}},[a("el-button",[e._v("取消")])],1):e._e()],1)],1)],1)])])},staticRenderFns:[]},o=a("VU/8")(s,r,!1,null,null,null).exports,n=(a("bjOP"),a("11nS"),{inject:["reload"],name:"honor",components:{rongyuchenghao:o},data:function(){return{role:localStorage.getItem("ms_role"),isimport:!1,tableData:[],pageTotal:0,query:{key:"",pageIndex:1,pageSize:10},cur_page:1,multipleSelection:[],select_cate:"",select_word:"",del_list:[],is_search:!1,editVisible:!1,delVisible:!1,form:{},idx:-1,idList:[],teacher_list:[]}},created:function(){var e=this;this.getData(),Object(i.m)().then(function(t){e.teacher_list=t})},computed:{data:function(){var e=this;return this.tableData.filter(function(t){for(var a=!1,l=0;l<e.del_list.length;l++)if(t.name===e.del_list[l].name){a=!0;break}if(!a&&t.address.indexOf(e.select_cate)>-1&&(t.name.indexOf(e.select_word)>-1||t.address.indexOf(e.select_word)>-1))return t})}},methods:{handleImport:function(){this.$refs.upload.submit(),this.isimport=!1,this.reload()},isimportHonor:function(){this.isimport=!0},handleCurrentChange:function(e){this.$set(this.query,"pageIndex",e),this.getData()},getData:function(){var e=this;""!==this.query.key?Object(l.f)(this.query).then(function(t){e.tableData=t.list,e.pageTotal=t.pageTotal}):Object(l.d)(this.query).then(function(t){e.tableData=t.list,e.pageTotal=t.pageTotal})},success:function(e,t,a){this.$message.success(e.msg)},search:function(){var e=this;Object(l.f)(this.query).then(function(t){e.tableData=t.list,e.pageTotal=t.pageTotal}),this.is_search=!0},onSubmit:function(){var e=this;this.editVisible=!1,Object(l.c)(this.form).then(function(t){0!==t?e.$message.success("修改成功"):e.$message.error("修改失败"),e.getData()})},formatter:function(e,t){return e.address},filterTag:function(e,t){return t.tag===e},handleEdit:function(e,t){var a=this;console.log(t),Object(l.e)({id:t.object.id}).then(function(e){a.form.people=e.data}),this.form=t.object,this.editVisible=!0},handleDelete:function(e,t){var a=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then(function(){Object(l.a)({id:t.id}).then(function(e){a.getData(),a.$message.success("删除成功")}).catch(function(){a.$message.error("删除失败")})}).catch(function(){})},delAll:function(){var e=this;this.idList.length>0&&this.$confirm("确定要删除吗？","提示",{type:"warning"}).then(function(){Object(l.b)({ids:e.idList}).then(function(t){e.$message.success("删除成功"),e.getData()})})},handleSelectionChange:function(e){this.idList=[];for(var t=0;t<e.length;t++)this.idList.push(e[t].object.id)},saveEdit:function(){var e=this;this.editVisible=!1,Object(l.g)(this.form).then(function(t){e.$message.success("修改成功"),e.getData()}),this.$message.success("修改第 "+(this.idx+1)+" 行成功")},deleteRow:function(){this.tableData.splice(this.idx,1),this.$message.success("删除成功"),this.delVisible=!1}}}),c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-tickets"}),e._v("荣誉称号")])],1)],1),e._v(" "),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"delete"},on:{click:e.delAll}},[e._v("批量删除")]),e._v(" "),a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"筛选关键词"},model:{value:e.query.key,callback:function(t){e.$set(e.query,"key",t)},expression:"query.key"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"search"},on:{click:e.search}},[e._v("搜索")])],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"object.id",label:"ID",width:"55",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"object.name",label:"称号名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"object.partment",label:"部门",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"object.level",label:"级别",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"object.finishtime",label:"获奖时间",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"object.teacher",label:"获奖教师",align:"center"}}),e._v(" "),"4"===e.role?a("el-table-column",{attrs:{label:"操作",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])}):e._e()],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total,prev, pager, next",total:e.pageTotal},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("router-link",{attrs:{to:"/荣誉称号申报"}},[a("el-button",{attrs:{type:"primary"}},[e._v("荣誉称号申报")])],1),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.isimportHonor}},[a("i",{staticClass:"el-icon-upload el-icon--left"}),e._v(" 批量导入")])],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:e.editVisible,width:"80%"},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"称号名称"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"级别"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",t)},expression:"form.level"}},[a("el-option",{key:"YuanJi",attrs:{label:"院级",value:"院级"}}),e._v(" "),a("el-option",{key:"XiaoJi",attrs:{label:"校级",value:"校级"}}),e._v(" "),a("el-option",{key:"ShengJi",attrs:{label:"省级",value:"省级"}}),e._v(" "),a("el-option",{key:"GuoJia",attrs:{label:"国家级",value:"国家级"}}),e._v(" "),a("el-option",{key:"GuoJi",attrs:{label:"国际级",value:"国际级"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"部门"}},[a("el-input",{model:{value:e.form.partment,callback:function(t){e.$set(e.form,"partment",t)},expression:"form.partment"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"获奖教师"}},[a("el-input",{model:{value:e.form.teacher,callback:function(t){e.$set(e.form,"teacher",t)},expression:"form.teacher"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"完成时间"}},[a("el-col",{attrs:{span:11}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.form.finishtime,callback:function(t){e.$set(e.form,"finishtime",t)},expression:"form.finishtime"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")]),e._v(" "),a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取消")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"提示",visible:e.delVisible,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible=t}}},[a("div",{staticClass:"del-dialog-cnt"},[e._v("删除不可恢复，是否确定删除？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.delVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.deleteRow}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"荣誉称号导入",visible:e.isimport,width:"40%"},on:{"update:visible":function(t){e.isimport=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[a("h3",[e._v("模板示例")]),e._v(" "),a("br"),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{border:"black solid 1px",margin:"auto"},attrs:{src:"static/img/honor.PNG"}})]),e._v(" "),a("br"),e._v(" "),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{align:"center",drag:"",accept:".xls,.xlsx","auto-upload":!1,action:"http://localhost:8080/honorImport","on-success":e.success,multiple:""}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将Excel文件拖到此处，或"),a("em",[e._v("点击上传")])])])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.isimport=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleImport}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var u=a("VU/8")(n,c,!1,function(e){a("O81N")},"data-v-2175a705",null);t.default=u.exports}});